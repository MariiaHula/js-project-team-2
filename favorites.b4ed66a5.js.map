{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,8GAYA,MAAMC,EAAsBC,SAASC,cAAc,sBAC7CC,EAAmBF,SAASC,cAAc,yBAC1CE,EAAkBH,SAASC,cAAc,wBACzCG,EAAaJ,SAASC,cAAc,qBACpCI,EAAYL,SAASC,cAAc,eACnCK,EAAYN,SAASC,cAAc,gBACnCM,EAAYP,SAASC,cAAc,gBACnCO,EAAcR,SAASC,cAAc,iBACrCQ,EAAeT,SAASC,cAAc,uBACtCS,EAAcV,SAASC,cAAc,oBAS3C,SAASU,EAAgBC,GACrBV,EAAiBW,UAAUC,OAAO,+BAEjCf,EAAoBgB,oBAAoB,QAASJ,GAClDT,EAAiBa,oBAAoB,QAASC,GAC9CC,OAAOF,oBAAoB,UAAWG,E,CAU1C,SAASF,EAAgBJ,GACjBA,EAAEO,SAAWjB,GACbS,G,CAIR,SAASO,EAAgBN,GACN,WAAVA,EAAEQ,KACHT,G,CA5BRR,EAAgBkB,iBAAiB,SAajC,SAAwBT,GACpBV,EAAiBW,UAAUS,IAAI,+BAC/BvB,EAAoBsB,iBAAiB,QAASV,GAC7CT,EAAiBmB,iBAAiB,QAASL,GAC5CC,OAAOI,iBAAiB,UAAWH,E,IAiBvCd,EAAWiB,iBAAiB,UAE5B,SAAuBT,GAEnBA,EAAEW,iBAEE,MAAMC,EAAc,IAAI,EAAA3B,EAAA4B,eAClBC,EAAU,CACZC,KAAQtB,EAAUuB,MAC5BC,MAAStB,EAAUqB,MACnBE,MAASxB,EAAUsB,MACnBG,QAAWvB,EAAYoB,OAIpBnB,EAAauB,MAAMC,QAAU,QAC9BvB,EAAYG,UAAUS,IAAI,kBACzBY,YAAW,MAUZC,eAA0BX,EAAaE,GAE/B,UACuBF,EAAYY,YAAYV,GAE3CW,EAAAC,OAAOC,QAAQ,wBAC5BrC,EAAiBW,UAAUC,OAAO,8B,CAGzB,MAAO0B,GACHC,QAAQC,IAAI,QAASF,GACrBH,EAAAC,OAAOK,QAAQ,yBACfvC,EAAWwC,QACX1C,EAAiBW,UAAUC,OAAO,8B,EAtB1C+B,CAAWrB,EAAaE,GAGvBjB,EAAauB,MAAMC,QAAU,OAC7BvB,EAAYG,UAAUC,OAAO,iBAAiB,GAChD,I,IAuBP,MAAMgC,EAAe9C,SAASC,cAAc,mBACtC8C,EAAmB/C,SAASC,cAAc,yBAC1C+C,EAAgBhD,SAASC,cAAc,cAE7C,IACIgD,EADAC,EAAsB,IAAI,EAAArD,EAAA4B,eAAc,MAG5CU,iBAEI,IACI,MAAMgB,QAAiBD,EAAoBE,aAE3C,IAAIC,EAASC,EAAAC,QAAaC,KAAK,qBAC3BC,EAAYN,EAASO,QAErBC,MAAMC,QAAQP,GACdI,EAAYA,EAAUI,QAAOC,GAClBT,EAAOU,SAASC,OAAOF,EAAQG,SAG5CR,EAAY,GACZT,EAAcnC,UAAUC,OAAO,cAGnC,MAAMoD,EAkEZ,SAA2BC,GAEzB,IAAID,EAAa,CAAC,kBAElB,KAAIP,MAAMC,QAAQO,IAAQA,EAAIC,OAAS,GAKrC,MAAO,GAJLF,EAAaA,EAAWG,OACxBF,EAAIG,KAAIR,GAAWA,EAAQS,WAAUV,QAAO,CAACW,EAAMC,EAAKC,IAAiBA,EAAIC,QAAQH,KAAUC,KAYnG,OAPeP,EAAWI,KAAIM,GACrB,sFAE0DA,MAAOA,8BAGvEC,KAAK,G,CAnFeC,CAAkBrB,GAGrC,GAFAV,EAAiBgC,UAAYb,EAC7BpB,EAAaiC,WAAY,EAAAC,EAAAC,mBAAkBxB,GACxB,KAAfS,EAEF,YADC7B,EAAAC,OAAOK,QAAQ,4CAGlBK,EAAcnC,UAAUS,IAAI,cAC5B,EAAA0D,EAAAE,gBAAe,mBAEf,MAAMC,EAAUpC,EAAiBqC,SACjC,IAAKC,MAAMF,EAAS,CACLE,GAAGD,SAAS,GAClB/D,iBAAiB,SAASiE,IAC/B,IAAIxB,EAAUwB,EAAMnE,OAEpB,GAAoC,mBAAhC2C,EAAQyB,QAAkB,SAAwB,CACpD,IAAIC,EAAkB/B,EAAUI,QAAOe,GAC9BA,EAAGL,WAAaT,EAAQyB,QAAkB,WAEnDzC,EAAaiC,WAAY,EAAAC,EAAAC,mBAAkBO,E,MAE3C1C,EAAaiC,WAAY,EAAAC,EAAAC,mBAAkBxB,IAE7C,EAAAuB,EAAAE,gBAAe,kBAAkB,G,CAKvC,MAAMO,EAAU,CACZC,WAAYvC,EAASO,QAAQU,OAASjB,EAASwC,WAC/CC,aAAc1C,EAAoB2C,QAClCC,aAAc,EACdC,KAAM7C,EAAoB6C,MAGX,IAAIC,EAAAC,GAAJ,CAAe,aAAcR,GAErCS,GAAG,aAAa/D,MAAMmD,IAC9BpC,EAAoB6C,KAAOT,EAAMS,KAClC,IACI,MAAMI,QAAiBjD,EAAoBE,aAC7C,IAAIgD,EAAS9C,EAAAC,QAAaC,KAAK,qBAC3B6C,EAAYF,EAASzC,QAErBC,MAAMC,QAAQwC,KACdC,EAAYA,EAAUxC,QAAOC,GAClBsC,EAAOrC,SAASC,OAAOF,EAAQG,SAG9CnB,EAAaiC,WAAY,EAAAC,EAAAC,mBAAkBoB,IAExC,EAAArB,EAAAE,gBAAe,kB,CAClB,MAAO1C,GACPC,QAAQC,IAAIF,E,KAGhB,MAAOA,GACPC,QAAQC,IAAIF,E,CAGdS,EAAcjD,SAASC,cAAc,mBACrCgD,EAAY5B,iBAAiB,QAASiF,EAAAC,0B,CAExCC","sources":["src/favorites.js"],"sourcesContent":["import './js/axios_api';\nimport './js/header';\nimport localStorage from './js/localStorage';\nimport { goitGlobalAPI } from './js/axios_api';\nimport { markupGalleryCard, checkFavorites } from './js/render-gallery';\nimport { openModalGaleryRecipesPre } from './js/modal-recipes';\nimport './js/modal-rating';\nimport Pagination from 'tui-pagination';\nimport '../node_modules/tui-pagination/dist/tui-pagination.css';  \n\n    import { Notify } from 'notiflix/build/notiflix-notify-aio';\n\nconst closeIconOrderModal = document.querySelector('.modal-order-close');\nconst windowOrderModal = document.querySelector('.modal-order-backdrop');\nconst openOrderBusket = document.querySelector('.header-busket-order');\nconst formOreder = document.querySelector('.modal-order-form');\nconst orderName = document.querySelector('#input_name');\nconst formEmail = document.querySelector('#input_email');\nconst formPhone = document.querySelector('#input_phone');\nconst formComment = document.querySelector('.user-message');\nconst orderSpinner = document.querySelector('.modal-order-loader');\nconst modalOrdBtn = document.querySelector('.modal-order-btn');\n\n\n\nopenOrderBusket.addEventListener('click', openOrderModal);\n\n\n\n\nfunction closeOrderModal(e) {\n    windowOrderModal.classList.remove('modal-order-backdrop-active'); \n\n     closeIconOrderModal.removeEventListener(\"click\", closeOrderModal);\n    windowOrderModal.removeEventListener(\"click\", closeOrderByBcg);\n    window.removeEventListener(\"keydown\", closeOrderByEsc);\n}\n\nfunction openOrderModal(e) {\n    windowOrderModal.classList.add('modal-order-backdrop-active'); \n    closeIconOrderModal.addEventListener('click', closeOrderModal);\n     windowOrderModal.addEventListener('click', closeOrderByBcg);\n    window.addEventListener('keydown', closeOrderByEsc)\n}\n\nfunction closeOrderByBcg(e) {\n    if (e.target === windowOrderModal) {\n        closeOrderModal(e);\n     }\n}\n\nfunction closeOrderByEsc(e) {\n     if (e.key === \"Escape\") {\n        closeOrderModal(e);\n    }\n}\n\n\n\nformOreder.addEventListener('submit', sendOrderForm);\n\nfunction sendOrderForm(e) {\n     \n    e.preventDefault();\n \n        const addOrderApi = new goitGlobalAPI();\n        const dataAPI = {\n            \"name\": orderName.value,\n  \"phone\": formPhone.value,\n  \"email\": formEmail.value,\n  \"comment\": formComment.value,\n    }\n\n\n     orderSpinner.style.display = 'block';\n    modalOrdBtn.classList.add('non-active-btn');\n     setTimeout(() => {\n        addOrderFn(addOrderApi, dataAPI);\n\n        // Після завершення відправки, приховати спіннер\n         orderSpinner.style.display = 'none';\n         modalOrdBtn.classList.remove('non-active-btn');\n    }, 2000);\n    \n    }\n\n    async function addOrderFn(addOrderApi, dataAPI) {\n    \n            try {\n                const data = await addOrderApi.createOrder(dataAPI);\n                // console.log(\"Order\", data);\n                Notify.success('We got your opinion!');\n   windowOrderModal.classList.remove('modal-order-backdrop-active');\n        \n            }\n            catch (err) {\n                console.log(`Error`, err);\n                Notify.failure('Oops, something wrong');\n                formOreder.reset();\n                windowOrderModal.classList.remove('modal-order-backdrop-active');\n            }\n    \n} \n//===========RENDER from LOCALSTORAGE====================================\n\nconst favoriteList = document.querySelector('.favorites-list');\nconst favoritesWrapper = document.querySelector('.js-favorites-wrapper');\nconst blokedWrapper = document.querySelector('.js-bloked');\n\nlet favoritesGalleryAPI = new goitGlobalAPI(288);\nlet gallery_btn;\n\nasync function renderFavoritesCard() {\n    \n    try {\n        const response = await favoritesGalleryAPI.getRecipes();\n\n        let arrFav = localStorage.load('favorites-recipes');\n        let arrResult = response.results;\n\n        if (Array.isArray(arrFav)) {\n            arrResult = arrResult.filter(element => {\n                return arrFav.includes(String(element._id)); \n            })\n        } else {\n          arrResult = [];\n          blokedWrapper.classList.remove('is-hidden');\n        }\n\n      const categories = faveritesCategory(arrResult);\n      favoritesWrapper.innerHTML = categories;\n      favoriteList.innerHTML = markupGalleryCard(arrResult);\n      if (categories === '') {\n         Notify.failure('There is no such recipe in the favorites');\n        return;\n      }\n      blokedWrapper.classList.add('is-hidden');\n      checkFavorites('.favorites-list');\n       \n      const buttons = favoritesWrapper.children;\n      for (li of buttons) {\n        let button = li.children[0];\n        button.addEventListener('click', event => {\n          let element = event.target;\n\n          if (element.dataset['category'] !== 'All categories') {\n            let recipesFiltered = arrResult.filter(el => {\n              return el.category === element.dataset['category']\n            });\n            favoriteList.innerHTML = markupGalleryCard(recipesFiltered);\n          } else {\n            favoriteList.innerHTML = markupGalleryCard(arrResult);\n          }\n          checkFavorites('.favorites-list');\n        })\n      }\n\n\n    const options = {\n        totalItems: response.results.length * response.totalPages,\n        itemsPerPage: favoritesGalleryAPI.perPage,\n        visiblePages: 3,\n        page: favoritesGalleryAPI.page,\n    }\n\n    const pagination = new Pagination('pagination', options);\n        \n    pagination.on('afterMove', async event => {\n       favoritesGalleryAPI.page = event.page;\n      try {\n          const response = await favoritesGalleryAPI.getRecipes();\n        let arrFav = localStorage.load('favorites-recipes');\n        let arrResult = response.results;\n       \n        if (Array.isArray(arrFav)) {\n            arrResult = arrResult.filter(element => {\n                return arrFav.includes(String(element._id)); \n            })\n        }\n        favoriteList.innerHTML = markupGalleryCard(arrResult);\n\n           checkFavorites('.favorites-list');\n      } catch (err) {\n        console.log(err);\n      }\n    });\n  } catch (err) {\n    console.log(err);\n  }\n\n  gallery_btn = document.querySelector(\".favorites-list\");\n  gallery_btn.addEventListener(\"click\", openModalGaleryRecipesPre);\n}\nrenderFavoritesCard();\n\nfunction faveritesCategory(arr) {\n\n  let categories = ['All categories'];\n\n  if (Array.isArray(arr) && arr.length > 0) {\n      categories = categories.concat(\n      arr.map(element => element.category).filter((elem, ind, arr) => { return arr.indexOf(elem) === ind })\n    );\n  } else {\n    return '';\n  }\n  const markup = categories.map(el => {\n    return `\n        <li>\n        <button class=\"favorites-btn\" type=\"button\" data-category=\"${el}\">${el}</button>\n        </li>`;\n  })\n    .join('');\n  return markup;\n}\n\n\n"],"names":["$da7oM","parcelRequire","$5680453e957fa117$var$closeIconOrderModal","document","querySelector","$5680453e957fa117$var$windowOrderModal","$5680453e957fa117$var$openOrderBusket","$5680453e957fa117$var$formOreder","$5680453e957fa117$var$orderName","$5680453e957fa117$var$formEmail","$5680453e957fa117$var$formPhone","$5680453e957fa117$var$formComment","$5680453e957fa117$var$orderSpinner","$5680453e957fa117$var$modalOrdBtn","$5680453e957fa117$var$closeOrderModal","e","classList","remove","removeEventListener","$5680453e957fa117$var$closeOrderByBcg","window","$5680453e957fa117$var$closeOrderByEsc","target","key","addEventListener","add","preventDefault","addOrderApi","goitGlobalAPI","dataAPI","name","value","phone","email","comment","style","display","setTimeout","async","createOrder","$iQIUW","Notify","success","err","console","log","failure","reset","$5680453e957fa117$var$addOrderFn","$5680453e957fa117$var$favoriteList","$5680453e957fa117$var$favoritesWrapper","$5680453e957fa117$var$blokedWrapper","$5680453e957fa117$var$gallery_btn","$5680453e957fa117$var$favoritesGalleryAPI","response1","getRecipes","arrFav1","$31u3U","default","load","arrResult1","results","Array","isArray","filter","element","includes","String","_id","categories","arr1","length","concat","map","category","elem","ind","arr","indexOf","el","join","$5680453e957fa117$var$faveritesCategory","innerHTML","$34HY9","markupGalleryCard","checkFavorites","buttons","children","li","event","dataset","recipesFiltered","options","totalItems","totalPages","itemsPerPage","perPage","visiblePages","page","$parcel$interopDefault","$fb9GJ","on","response","arrFav","arrResult","$2H64r","openModalGaleryRecipesPre","$5680453e957fa117$var$renderFavoritesCard"],"version":3,"file":"favorites.b4ed66a5.js.map"}